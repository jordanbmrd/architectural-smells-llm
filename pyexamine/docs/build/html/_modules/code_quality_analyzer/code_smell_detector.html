<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>code_quality_analyzer.code_smell_detector &mdash; Code Quality Analyzer 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Code Quality Analyzer
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code_smell_detector.html">Code Smell Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architectural_smell_detector.html">Architectural Smell Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structural_smell_detector.html">Structural Smell Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../config_handler.html">Configuration Handler</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Code Quality Analyzer</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">code_quality_analyzer.code_smell_detector</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for code_quality_analyzer.code_smell_detector</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">astroid</span>
<span class="kn">from</span> <span class="nn">astroid</span> <span class="kn">import</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">exceptions</span> <span class="k">as</span> <span class="n">astroid_exceptions</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span><span class="p">,</span> <span class="n">product</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">.exceptions</span> <span class="kn">import</span> <span class="n">CodeAnalysisError</span>

<span class="c1"># Set up logger</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<div class="viewcode-block" id="CodeSmell">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmell">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">CodeSmell</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">module_class</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">line_number</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></div>


<div class="viewcode-block" id="CodeSmellDetector">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector">[docs]</a>
<span class="k">class</span> <span class="nc">CodeSmellDetector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to detect various code smells in Python source code.</span>

<span class="sd">    This class analyzes Python source code for common code smells and anti-patterns,</span>
<span class="sd">    providing a comprehensive report on potential issues in the codebase.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        code_smells (list): A list to store detected code smells.</span>
<span class="sd">        thresholds (dict): A dictionary of threshold values for various code smell detections.</span>
<span class="sd">        file_content (list): A list of strings representing the content of the analyzed file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CodeSmellDetector.__init__">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the CodeSmellDetector with given thresholds.</span>

<span class="sd">        Args:</span>
<span class="sd">            thresholds (dict): A dictionary of threshold values for various code smell detections.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span> <span class="o">=</span> <span class="n">thresholds</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_smells">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_smells">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_smells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect code smells in the given file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">detection_methods</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_long_methods</span><span class="p">,</span> <span class="s2">&quot;detect_long_methods&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_large_classes</span><span class="p">,</span> <span class="s2">&quot;detect_large_classes&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_primitive_obsession</span><span class="p">,</span> <span class="s2">&quot;detect_primitive_obsession&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_long_parameter_lists</span><span class="p">,</span> <span class="s2">&quot;detect_long_parameter_lists&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_data_clumps</span><span class="p">,</span> <span class="s2">&quot;detect_data_clumps&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_switch_statements</span><span class="p">,</span> <span class="s2">&quot;detect_switch_statements&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_temporary_fields</span><span class="p">,</span> <span class="s2">&quot;detect_temporary_fields&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_alternative_classes</span><span class="p">,</span> <span class="s2">&quot;detect_alternative_classes&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_divergent_change</span><span class="p">,</span> <span class="s2">&quot;detect_divergent_change&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_parallel_inheritance</span><span class="p">,</span> <span class="s2">&quot;detect_parallel_inheritance&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_shotgun_surgery</span><span class="p">,</span> <span class="s2">&quot;detect_shotgun_surgery&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_comments</span><span class="p">,</span> <span class="s2">&quot;detect_comments&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_duplicate_code</span><span class="p">,</span> <span class="s2">&quot;detect_duplicate_code&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_speculative_generality</span><span class="p">,</span> <span class="s2">&quot;detect_speculative_generality&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_feature_envy</span><span class="p">,</span> <span class="s2">&quot;detect_feature_envy&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_inappropriate_intimacy</span><span class="p">,</span> <span class="s2">&quot;detect_inappropriate_intimacy&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_message_chains</span><span class="p">,</span> <span class="s2">&quot;detect_message_chains&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_middle_man</span><span class="p">,</span> <span class="s2">&quot;detect_middle_man&quot;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">astroid</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">astroid_exceptions</span><span class="o">.</span><span class="n">AstroidSyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Syntax error in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">CodeAnalysisError</span><span class="p">(</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Failed to parse Python file: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                    <span class="n">line_number</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;lineno&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">file_content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            
            <span class="c1"># Run each detection method</span>
            <span class="k">for</span> <span class="n">detect_method</span><span class="p">,</span> <span class="n">method_name</span> <span class="ow">in</span> <span class="n">detection_methods</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running </span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">detect_method</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Error in </span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2"> analyzing </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
                        <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span>
                    <span class="p">)</span>
                    <span class="k">raise</span> <span class="n">CodeAnalysisError</span><span class="p">(</span>
                        <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Error in </span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">function_name</span><span class="o">=</span><span class="n">method_name</span>
                    <span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encoding error in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CodeAnalysisError</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;File encoding error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected error analyzing </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CodeAnalysisError</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Unexpected error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_long_methods">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_long_methods">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_long_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect long methods in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">):</span>
                <span class="c1"># Skip property decorators and simple getter/setters</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
                    <span class="n">is_property</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                        <span class="c1"># Handle both direct name and call decorators</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                            <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                            <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">is_property</span><span class="p">:</span>
                        <span class="k">continue</span>
                
                <span class="c1"># Count non-empty, non-comment lines</span>
                <span class="n">actual_lines</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">line_no</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">fromlineno</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">tolineno</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">line_no</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_content</span><span class="p">):</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_content</span><span class="p">[</span><span class="n">line_no</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">line</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
                            <span class="n">actual_lines</span> <span class="o">+=</span> <span class="mi">1</span>
                
                <span class="k">if</span> <span class="n">actual_lines</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;LONG_METHOD_LINES&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Long Method&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has </span><span class="si">{</span><span class="n">actual_lines</span><span class="si">}</span><span class="s2"> lines in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> at line </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span>
                    <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_large_classes">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_large_classes">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_large_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect large classes in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
                <span class="c1"># Skip data classes and exception classes</span>
                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                            <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">decorator</span><span class="o">.</span><span class="n">attrname</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">is_dataclass</span> <span class="ow">or</span>
                    <span class="nb">any</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Exception&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">bases</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">))):</span>
                    <span class="k">continue</span>

                <span class="c1"># Count non-trivial methods (exclude simple getters/setters)</span>
                <span class="n">non_trivial_methods</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">):</span>
                        <span class="c1"># Skip magic methods</span>
                        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
                            <span class="k">continue</span>
                        <span class="c1"># Skip simple getters/setters</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Return</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Assign</span><span class="p">)):</span>
                            <span class="k">continue</span>
                        <span class="n">non_trivial_methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_trivial_methods</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;LARGE_CLASS_METHODS&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Large Class&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">non_trivial_methods</span><span class="p">)</span><span class="si">}</span><span class="s2"> non-trivial methods in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span>
                    <span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_primitive_obsession">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_primitive_obsession">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_primitive_obsession</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect primitive obsession in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">):</span>
                <span class="n">primitives</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">total_args</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
                
                <span class="c1"># Skip if it&#39;s a small number of total arguments</span>
                <span class="k">if</span> <span class="n">total_args</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">AssignName</span><span class="p">):</span>
                        <span class="c1"># Skip &#39;self&#39; parameter in methods</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">arg</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;self&#39;</span><span class="p">:</span>
                            <span class="k">continue</span>
                        
                        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">annotations</span><span class="p">):</span>
                            <span class="n">arg_type</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_type</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> 
                                <span class="n">arg_type</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">]):</span>
                                <span class="n">primitives</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

                <span class="c1"># Calculate primitive ratio</span>
                <span class="n">primitive_ratio</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">primitives</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">total_args</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="s1">&#39;self&#39;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">else</span> <span class="n">total_args</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">primitives</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;PRIMITIVE_OBSESSION_COUNT&quot;</span><span class="p">]</span> <span class="ow">and</span> 
                    <span class="n">primitive_ratio</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">):</span>  <span class="c1"># More than 70% primitives</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Primitive Obsession&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">primitives</span><span class="p">)</span><span class="si">}</span><span class="s2"> primitive parameters in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span>
                    <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_long_parameter_lists">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_long_parameter_lists">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_long_parameter_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect long parameter lists in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">):</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">args</span>
                
                <span class="c1"># Skip if it&#39;s a constructor</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;__init__&#39;</span><span class="p">:</span>
                    <span class="k">continue</span>
                
                <span class="c1"># Skip &#39;self&#39; in method parameter count</span>
                <span class="k">if</span> <span class="n">args</span> <span class="ow">and</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;self&#39;</span><span class="p">:</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                
                <span class="c1"># Check for **kwargs or *args</span>
                <span class="n">has_var_args</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">vararg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="n">has_kwargs</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">kwarg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                
                <span class="c1"># Reduce severity if function has variable arguments</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;LONG_PARAMETER_LIST&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> 
                    <span class="k">if</span> <span class="p">(</span><span class="n">has_var_args</span> <span class="ow">or</span> <span class="n">has_kwargs</span><span class="p">)</span> 
                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;LONG_PARAMETER_LIST&quot;</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Long Parameter List&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="si">}</span><span class="s2"> parameters in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span>
                    <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_data_clumps">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_data_clumps">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_data_clumps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect data clumps in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameter_groups</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">):</span>
                <span class="c1"># Skip if it&#39;s a constructor or property</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;__init__&#39;</span> <span class="ow">or</span> <span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">decorators</span> <span class="ow">and</span> 
                    <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span> 
                        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">)):</span>
                    <span class="k">continue</span>
                
                <span class="c1"># Get parameters excluding self</span>
                <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">args</span> 
                         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">AssignName</span><span class="p">)</span> <span class="ow">and</span> <span class="n">arg</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;self&#39;</span><span class="p">]</span>
                
                <span class="c1"># Skip if too few parameters</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;DATA_CLUMPS_THRESHOLD&quot;</span><span class="p">]:</span>
                    <span class="k">continue</span>
                    
                <span class="c1"># Create combinations of parameters that appear together</span>
                <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">params</span><span class="p">),</span> <span class="n">size</span><span class="p">):</span>
                        <span class="n">parameter_groups</span><span class="p">[</span><span class="n">combo</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">params</span><span class="p">,</span> <span class="n">functions</span> <span class="ow">in</span> <span class="n">parameter_groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Only report if parameters appear together in multiple functions</span>
            <span class="c1"># and represent a significant portion of each function&#39;s parameters</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">functions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> 
                <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;DATA_CLUMPS_THRESHOLD&quot;</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Clumps&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Parameters </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="si">}</span><span class="s2"> appear together in functions: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">functions</span><span class="p">)</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                    <span class="n">module_class</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">functions</span><span class="p">),</span>
                    <span class="n">line_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_switch_statements">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_switch_statements">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_switch_statements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect switch statements in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">count_conditions</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Start with 1 for the initial if</span>
            <span class="k">for</span> <span class="n">else_node</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">orelse</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">else_node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">If</span><span class="p">):</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">else_node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Expr</span><span class="p">):</span>
                    <span class="k">continue</span>  <span class="c1"># Skip comments or docstrings</span>
            <span class="k">return</span> <span class="n">count</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">If</span><span class="p">):</span>
            <span class="c1"># Skip simple if/else statements</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">orelse</span><span class="p">:</span>
                <span class="k">continue</span>
                
            <span class="c1"># Check if this is part of a try/except block</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ExceptHandler</span><span class="p">)</span> <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">node_ancestors</span><span class="p">()):</span>
                <span class="k">continue</span>
                
            <span class="n">condition_count</span> <span class="o">=</span> <span class="n">count_conditions</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            
            <span class="c1"># Check for common valid patterns</span>
            <span class="n">is_guard_clause</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Compare</span><span class="p">)</span>
            <span class="n">is_type_check</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;isinstance&#39;</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="n">condition_count</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;COMPLEX_CONDITIONAL&quot;</span><span class="p">]</span> <span class="ow">and</span> 
                <span class="ow">not</span> <span class="n">is_guard_clause</span> <span class="ow">and</span> 
                <span class="ow">not</span> <span class="n">is_type_check</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Switch Statements&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Complex conditional with </span><span class="si">{</span><span class="n">condition_count</span><span class="si">}</span><span class="s2"> branches at line </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                    <span class="n">module_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>
                <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_temporary_fields">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_temporary_fields">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_temporary_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect temporary fields in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
                <span class="c1"># Skip data classes and exception classes</span>
                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                            <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">decorator</span><span class="o">.</span><span class="n">attrname</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">is_dataclass</span> <span class="ow">or</span>
                    <span class="nb">any</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Exception&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">bases</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">))):</span>
                    <span class="k">continue</span>

                <span class="n">init_fields</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                <span class="n">used_fields</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                <span class="n">cached_fields</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># For fields that might be used for caching</span>
                
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;__init__&#39;</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">child</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">AssignName</span><span class="p">):</span>
                                <span class="c1"># Check if field has a comment indicating it&#39;s for caching</span>
                                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">sibling</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Expr</span><span class="p">)</span> <span class="ow">and</span> 
                                      <span class="nb">isinstance</span><span class="p">(</span><span class="n">sibling</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Const</span><span class="p">)</span> <span class="ow">and</span> 
                                      <span class="s1">&#39;cache&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">sibling</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> 
                                      <span class="k">for</span> <span class="n">sibling</span> <span class="ow">in</span> <span class="n">child</span><span class="o">.</span><span class="n">body</span><span class="p">):</span>
                                    <span class="n">cached_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">init_fields</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">used_fields</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                                <span class="n">n</span><span class="o">.</span><span class="n">attrname</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">child</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">)</span>
                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;self&#39;</span>
                            <span class="p">)</span>
                
                <span class="c1"># Exclude common patterns and cached fields</span>
                <span class="n">temp_fields</span> <span class="o">=</span> <span class="p">(</span><span class="n">init_fields</span> <span class="o">-</span> <span class="n">used_fields</span> <span class="o">-</span> <span class="n">cached_fields</span> <span class="o">-</span> 
                             <span class="p">{</span><span class="s1">&#39;logger&#39;</span><span class="p">,</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;cache&#39;</span><span class="p">,</span> <span class="s1">&#39;_cache&#39;</span><span class="p">})</span>
                
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_fields</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;TEMPORARY_FIELD_THRESHOLD&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Temporary Field&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Potentially unused fields </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_fields</span><span class="p">)</span><span class="si">}</span><span class="s2"> in class &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; at line </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;low&#39;</span>
                    <span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_alternative_classes">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_alternative_classes">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_alternative_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect alternative classes with different interfaces in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">class_methods</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
                <span class="c1"># Skip data classes, exceptions, and abstract base classes</span>
                <span class="n">is_excluded</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;dataclass&#39;</span><span class="p">,</span> <span class="s1">&#39;abstractmethod&#39;</span><span class="p">}:</span>
                            <span class="n">is_excluded</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;dataclass&#39;</span><span class="p">,</span> <span class="s1">&#39;abstractmethod&#39;</span><span class="p">}:</span>
                                <span class="n">is_excluded</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">decorator</span><span class="o">.</span><span class="n">attrname</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;dataclass&#39;</span><span class="p">,</span> <span class="s1">&#39;abstractmethod&#39;</span><span class="p">}:</span>
                                <span class="n">is_excluded</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">is_excluded</span> <span class="ow">or</span>
                    <span class="nb">any</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;Exception&#39;</span><span class="p">,</span> <span class="s1">&#39;ABC&#39;</span><span class="p">))</span> 
                        <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">bases</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">))):</span>
                    <span class="k">continue</span>
                
                <span class="c1"># Get non-private methods excluding standard methods</span>
                <span class="n">methods</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span>
                    <span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">mymethods</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;__init__&#39;</span><span class="p">,</span> <span class="s1">&#39;__str__&#39;</span><span class="p">,</span> <span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;__eq__&#39;</span><span class="p">,</span> <span class="s1">&#39;__hash__&#39;</span><span class="p">}</span>
                <span class="p">)</span>
                
                <span class="c1"># Skip if too few methods</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">continue</span>
                    
                <span class="n">class_methods</span><span class="p">[</span><span class="n">methods</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">methods</span><span class="p">,</span> <span class="n">classes</span> <span class="ow">in</span> <span class="n">class_methods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;ALTERNATIVE_CLASSES_THRESHOLD&quot;</span><span class="p">]:</span>
                <span class="c1"># Check if classes share a common base class</span>
                <span class="n">class_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span> 
                             <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">)</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">]</span>
                <span class="n">share_base_class</span> <span class="o">=</span> <span class="nb">len</span><span class="p">({</span><span class="n">base</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">class_nodes</span> 
                                      <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">bases</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)})</span> <span class="o">&gt;</span> <span class="mi">0</span>
                
                <span class="k">if</span> <span class="ow">not</span> <span class="n">share_base_class</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alternative Classes with Different Interfaces&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Classes </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span><span class="si">}</span><span class="s2"> share similar methods </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">classes</span><span class="p">),</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>
                    <span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_divergent_change">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_divergent_change">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_divergent_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect divergent change in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
                <span class="c1"># Skip data classes, exceptions, and utility classes</span>
                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                            <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">decorator</span><span class="o">.</span><span class="n">attrname</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">is_dataclass</span> <span class="ow">or</span>
                    <span class="nb">any</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Exception&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">bases</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">))</span> <span class="ow">or</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;Utils&#39;</span><span class="p">,</span> <span class="s1">&#39;Helper&#39;</span><span class="p">,</span> <span class="s1">&#39;Mixin&#39;</span><span class="p">))):</span>
                    <span class="k">continue</span>

                <span class="c1"># Get method prefixes, excluding common patterns</span>
                <span class="n">method_prefixes</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">mymethods</span><span class="p">():</span>
                    <span class="c1"># Skip magic methods, properties, and private methods</span>
                    <span class="n">is_property</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">method</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                                <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>
                            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                                    <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                                    <span class="k">break</span>
                            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                                <span class="k">if</span> <span class="n">decorator</span><span class="o">.</span><span class="n">attrname</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                                    <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                                    <span class="k">break</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_property</span> <span class="ow">or</span> <span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)):</span>
                        <span class="k">continue</span>
                        
                    <span class="n">prefix</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="c1"># Skip common CRUD and utility prefixes</span>
                    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="s1">&#39;set&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;has&#39;</span><span class="p">,</span> <span class="s1">&#39;validate&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="s1">&#39;update&#39;</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">}:</span>
                        <span class="n">method_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>

                <span class="n">unique_prefixes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">method_prefixes</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_prefixes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;DIVERGENT_CHANGE_PREFIXES&quot;</span><span class="p">]</span> <span class="ow">and</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">method_prefixes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;DIVERGENT_CHANGE_METHODS&quot;</span><span class="p">]):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Potential Divergent Change&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Class &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_prefixes</span><span class="p">)</span><span class="si">}</span><span class="s2"> different method prefixes: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unique_prefixes</span><span class="p">)</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>
                    <span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_parallel_inheritance">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_parallel_inheritance">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_parallel_inheritance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect parallel inheritance hierarchies in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">class_hierarchies</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">class_info</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Store class information for better analysis</span>
        
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
                <span class="c1"># Skip exception classes and mixins</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Exception&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">bases</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">))</span> <span class="ow">or</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Mixin&#39;</span><span class="p">)):</span>
                    <span class="k">continue</span>
                    
                <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">bases</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">):</span>
                        <span class="n">class_hierarchies</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                        <span class="c1"># Store method names for similarity comparison</span>
                        <span class="n">class_info</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">mymethods</span><span class="p">()</span> 
                                           <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)}</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_hierarchies</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">parallel_hierarchies</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">h1</span><span class="p">,</span> <span class="n">h2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">class_hierarchies</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># Check for naming patterns</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">h1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">c2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">h2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)):</span>
                        <span class="c1"># Check for method similarity</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">h1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">class_info</span> <span class="ow">and</span> <span class="n">h2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">class_info</span> <span class="ow">and</span> 
                            <span class="p">(</span><span class="n">class_info</span><span class="p">[</span><span class="n">h1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="ow">or</span> <span class="n">class_info</span><span class="p">[</span><span class="n">h2</span><span class="p">[</span><span class="mi">0</span><span class="p">]])):</span>  <span class="c1"># Ensure at least one set has methods</span>
                            <span class="n">union_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_info</span><span class="p">[</span><span class="n">h1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">|</span> <span class="n">class_info</span><span class="p">[</span><span class="n">h2</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                            <span class="k">if</span> <span class="n">union_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Prevent division by zero</span>
                                <span class="n">similarity</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_info</span><span class="p">[</span><span class="n">h1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&amp;</span> <span class="n">class_info</span><span class="p">[</span><span class="n">h2</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">/</span> <span class="n">union_size</span>
                                <span class="k">if</span> <span class="n">similarity</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">:</span>  <span class="c1"># More than 30% similar methods</span>
                                    <span class="n">parallel_hierarchies</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">parallel_hierarchies</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Parallel Inheritance Hierarchies&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Parallel hierarchies detected: </span><span class="si">{</span><span class="s1">&#39; and &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">parallel_hierarchies</span><span class="p">])</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                    <span class="n">module_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">line_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;high&#39;</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_shotgun_surgery">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_shotgun_surgery">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_shotgun_surgery</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect potential shotgun surgery in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">method_calls</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">):</span>
                    <span class="c1"># Skip common utility methods and logging</span>
                    <span class="k">if</span> <span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;print&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;len&#39;</span><span class="p">,</span> <span class="s1">&#39;isinstance&#39;</span><span class="p">,</span> <span class="s1">&#39;super&#39;</span><span class="p">}:</span>
                        <span class="k">continue</span>
                        
                    <span class="c1"># Store both line number and context</span>
                    <span class="n">context</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">node_ancestors</span><span class="p">():</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">)):</span>
                            <span class="n">context</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">name</span>
                            <span class="k">break</span>
                    <span class="n">method_calls</span><span class="p">[</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">call</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">context</span><span class="p">))</span>
        
        <span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">calls</span> <span class="ow">in</span> <span class="n">method_calls</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">unique_contexts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">context</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">context</span> <span class="ow">in</span> <span class="n">calls</span><span class="p">))</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">calls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;SHOTGUN_SURGERY_CALLS&quot;</span><span class="p">]</span> <span class="ow">and</span>
                <span class="n">unique_contexts</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;SHOTGUN_SURGERY_CONTEXTS&quot;</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Potential Shotgun Surgery&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Method &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39; called in </span><span class="si">{</span><span class="n">unique_contexts</span><span class="si">}</span><span class="s2"> different contexts across </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">calls</span><span class="p">)</span><span class="si">}</span><span class="s2"> locations in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                    <span class="n">module_class</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                    <span class="n">line_number</span><span class="o">=</span><span class="n">calls</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;high&#39;</span>
                <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_comments">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_comments">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect excessive comments in the given module and file.</span>

<span class="sd">        Args:</span>
<span class="sd">            module (astroid.Module): The AST module being analyzed</span>
<span class="sd">            file_path (str): Path to the file being analyzed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">comment_blocks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_block</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">code_lines</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_content</span><span class="p">):</span>
            <span class="n">stripped_line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">stripped_line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
                <span class="n">current_block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">current_block</span><span class="p">:</span>
                    <span class="n">comment_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_block</span><span class="p">)</span>
                    <span class="n">current_block</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">stripped_line</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">stripped_line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&quot;&quot;&quot;&#39;</span><span class="p">):</span>
                    <span class="n">code_lines</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="k">if</span> <span class="n">current_block</span><span class="p">:</span>
            <span class="n">comment_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_block</span><span class="p">)</span>
        
        <span class="c1"># Filter out license headers and module docstrings</span>
        <span class="k">if</span> <span class="n">comment_blocks</span> <span class="ow">and</span> <span class="n">comment_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">comment_blocks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># Calculate meaningful metrics</span>
        <span class="n">comment_lines</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">comment_blocks</span><span class="p">)</span>
        <span class="n">comment_ratio</span> <span class="o">=</span> <span class="n">comment_lines</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">code_lines</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">large_comment_blocks</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">comment_blocks</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">comment_ratio</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;EXCESSIVE_COMMENTS_RATIO&quot;</span><span class="p">]</span> <span class="ow">and</span>
            <span class="n">large_comment_blocks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;LARGE_COMMENT_BLOCKS&quot;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Excessive Comments&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;File has </span><span class="si">{</span><span class="n">comment_ratio</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> comment ratio with </span><span class="si">{</span><span class="n">large_comment_blocks</span><span class="si">}</span><span class="s2"> large comment blocks in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                <span class="n">module_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">line_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;low&#39;</span>
            <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_duplicate_code">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_duplicate_code">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_duplicate_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect duplicate code in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">normalize_code</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Normalize code by removing variable names and whitespace.&quot;&quot;&quot;</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
            <span class="c1"># Replace variable names with placeholders</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b[a-zA-Z_]\w*\b&#39;</span><span class="p">,</span> <span class="s1">&#39;VAR&#39;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
            <span class="c1"># Remove whitespace and comments</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;#.*$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">code</span>

        <span class="n">code_blocks</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">):</span>
                <span class="c1"># Skip small functions and test methods</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;DUPLICATE_CODE_MIN_LINES&quot;</span><span class="p">]</span> <span class="ow">or</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;test_&#39;</span><span class="p">)):</span>
                    <span class="k">continue</span>
                    
                <span class="c1"># Skip simple getter/setter methods</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Return</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Assign</span><span class="p">)):</span>
                    <span class="k">continue</span>
                    
                <span class="n">normalized_code</span> <span class="o">=</span> <span class="n">normalize_code</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="n">code_blocks</span><span class="p">[</span><span class="n">normalized_code</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">)))</span>
        
        <span class="k">for</span> <span class="n">block</span><span class="p">,</span> <span class="n">functions</span> <span class="ow">in</span> <span class="n">code_blocks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">functions</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;DUPLICATE_CODE_THRESHOLD&quot;</span><span class="p">]:</span>
                <span class="n">total_lines</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lines</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">lines</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Duplicate Code&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Similar code found in functions: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">functions</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">total_lines</span><span class="si">}</span><span class="s2"> total lines) in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                    <span class="n">module_class</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">),</span>
                    <span class="n">line_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;high&#39;</span>
                <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_data_class">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_data_class">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_data_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect data classes in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
                <span class="c1"># Skip if it&#39;s already a dataclass or an exception</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">decorator</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span> <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span> <span class="k">else</span> <span class="kc">False</span> <span class="ow">or</span>
                    <span class="nb">any</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Exception&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">bases</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">))):</span>
                    <span class="k">continue</span>

                <span class="n">methods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">mymethods</span><span class="p">())</span>
                
                <span class="c1"># Skip empty classes or those with no methods</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">methods</span><span class="p">:</span>
                    <span class="k">continue</span>
                    
                <span class="c1"># Count different types of methods</span>
                <span class="n">getters</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">setters</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">others</span> <span class="o">=</span> <span class="mi">0</span>
                
                <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
                        <span class="k">continue</span>  <span class="c1"># Skip magic methods</span>
                    <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;get_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">getters</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;set_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">setters</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">others</span> <span class="o">+=</span> <span class="mi">1</span>
                
                <span class="c1"># Only flag if class is predominantly getters/setters</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">others</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">getters</span> <span class="o">+</span> <span class="n">setters</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;DATA_CLASS_METHODS&quot;</span><span class="p">]</span> <span class="ow">and</span>
                    <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;DTO&#39;</span><span class="p">,</span> <span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="s1">&#39;Entity&#39;</span><span class="p">,</span> <span class="s1">&#39;Record&#39;</span><span class="p">))):</span>  <span class="c1"># Skip known data structures</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Class&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Class &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has </span><span class="si">{</span><span class="n">getters</span><span class="si">}</span><span class="s2"> getters and </span><span class="si">{</span><span class="n">setters</span><span class="si">}</span><span class="s2"> setters with no other methods in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>
                    <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_dead_code">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_dead_code">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_dead_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect dead code in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">defined_functions</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Store function with its decorator info</span>
        <span class="n">called_functions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">exported_functions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># Functions that might be used externally</span>
        
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">):</span>
                <span class="c1"># Skip test functions and property methods</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;test_&#39;</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">decorators</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">))):</span>
                    <span class="k">continue</span>
                    
                <span class="c1"># Check for decorators that suggest external use</span>
                <span class="n">has_public_decorator</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">decorator</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">,</span> <span class="s1">&#39;route&#39;</span><span class="p">,</span> <span class="s1">&#39;endpoint&#39;</span><span class="p">,</span> <span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">]):</span>
                            <span class="n">has_public_decorator</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">break</span>
                
                <span class="n">defined_functions</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">has_public_decorator</span>
                
                <span class="c1"># Check if function is likely to be exported</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">or</span>  <span class="c1"># Public functions</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)):</span>      <span class="c1"># Magic methods</span>
                    <span class="n">exported_functions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    
            <span class="c1"># Collect function calls</span>
            <span class="k">for</span> <span class="n">call</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">):</span>
                    <span class="n">called_functions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                    <span class="n">called_functions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">call</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">attrname</span><span class="p">)</span>
        
        <span class="c1"># Consider only truly unused functions</span>
        <span class="n">unused_functions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">func_name</span><span class="p">,</span> <span class="n">has_public_decorator</span> <span class="ow">in</span> <span class="n">defined_functions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">func_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">called_functions</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="n">has_public_decorator</span> <span class="ow">and</span>
                <span class="n">func_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exported_functions</span><span class="p">):</span>
                <span class="n">unused_functions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">func_name</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unused_functions</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;DEAD_CODE_THRESHOLD&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">unused_functions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dead Code&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Potentially unused function &#39;</span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s2">&#39; in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                    <span class="n">module_class</span><span class="o">=</span><span class="n">func</span><span class="p">,</span>
                    <span class="n">line_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;low&#39;</span>
                <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_lazy_class">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_lazy_class">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_lazy_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect lazy classes in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
                <span class="c1"># Skip known valid small classes</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> 
                    <span class="p">[</span><span class="s1">&#39;Exception&#39;</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Mixin&#39;</span><span class="p">,</span> <span class="s1">&#39;Interface&#39;</span><span class="p">,</span> <span class="s1">&#39;Abstract&#39;</span><span class="p">,</span> <span class="s1">&#39;Base&#39;</span><span class="p">])</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">decorators</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">))):</span>
                    <span class="k">continue</span>
                
                <span class="c1"># Count non-trivial methods</span>
                <span class="n">methods</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">mymethods</span><span class="p">():</span>
                    <span class="c1"># Skip magic methods and simple getters/setters</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)</span> <span class="ow">or</span>
                        <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Return</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Assign</span><span class="p">)))):</span>
                        <span class="k">continue</span>
                    <span class="n">methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
                
                <span class="c1"># Check complexity of methods</span>
                <span class="n">total_lines</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">tolineno</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">fromlineno</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;LAZY_CLASS_METHODS&quot;</span><span class="p">]</span> <span class="ow">and</span>
                    <span class="n">total_lines</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;LAZY_CLASS_LINES&quot;</span><span class="p">]):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Lazy Class&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Class &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has only </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span><span class="si">}</span><span class="s2"> non-trivial methods with </span><span class="si">{</span><span class="n">total_lines</span><span class="si">}</span><span class="s2"> total lines in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;low&#39;</span>
                    <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_speculative_generality">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_speculative_generality">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_speculative_generality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect speculative generality in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
                <span class="c1"># Skip legitimate abstract base classes</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">bases</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">))</span> <span class="ow">or</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;Interface&#39;</span><span class="p">,</span> <span class="s1">&#39;Base&#39;</span><span class="p">,</span> <span class="s1">&#39;Abstract&#39;</span><span class="p">))):</span>
                    <span class="k">continue</span>
                
                <span class="n">abstract_methods</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">unused_params</span> <span class="o">=</span> <span class="p">[]</span>
                
                <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">mymethods</span><span class="p">():</span>
                    <span class="c1"># Check for empty/pass methods</span>
                    <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">body</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Pass</span><span class="p">):</span>
                        <span class="n">abstract_methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    
                    <span class="c1"># Check for unused parameters</span>
                    <span class="n">used_names</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">method</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)}</span>
                    <span class="n">param_names</span> <span class="o">=</span> <span class="p">{</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">method</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">args</span> <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;self&#39;</span><span class="p">}</span>
                    <span class="n">unused</span> <span class="o">=</span> <span class="n">param_names</span> <span class="o">-</span> <span class="n">used_names</span>
                    <span class="k">if</span> <span class="n">unused</span><span class="p">:</span>
                        <span class="n">unused_params</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">unused</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">abstract_methods</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;SPECULATIVE_GENERALITY_THRESHOLD&quot;</span><span class="p">]</span> <span class="ow">or</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">unused_params</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;UNUSED_PARAMETERS_THRESHOLD&quot;</span><span class="p">]):</span>
                    <span class="n">description</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">if</span> <span class="n">abstract_methods</span><span class="p">:</span>
                        <span class="n">description</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">abstract_methods</span><span class="p">)</span><span class="si">}</span><span class="s2"> empty methods: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">abstract_methods</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">unused_params</span><span class="p">:</span>
                        <span class="n">description</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unused_params</span><span class="p">)</span><span class="si">}</span><span class="s2"> unused parameters: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unused_params</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Speculative Generality&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Class &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; </span><span class="si">{</span><span class="s1">&#39; and &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">description</span><span class="p">)</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>
                    <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_feature_envy">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_feature_envy">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_feature_envy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect feature envy in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">):</span>
                <span class="c1"># Skip property methods and simple delegators</span>
                <span class="n">is_property</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                            <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                                <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">decorator</span><span class="o">.</span><span class="n">attrname</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                                <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">is_property</span> <span class="ow">or</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Return</span><span class="p">)):</span>
                    <span class="k">continue</span>
                
                <span class="c1"># Track method calls by class</span>
                <span class="n">class_calls</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
                <span class="n">local_calls</span> <span class="o">=</span> <span class="mi">0</span>
                
                <span class="k">for</span> <span class="n">sub_node</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_node</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">sub_node</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;self&#39;</span><span class="p">:</span>
                            <span class="n">local_calls</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Skip common utility objects</span>
                            <span class="k">if</span> <span class="n">sub_node</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;logger&#39;</span><span class="p">,</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;utils&#39;</span><span class="p">,</span> <span class="s1">&#39;helper&#39;</span><span class="p">}:</span>
                                <span class="n">class_calls</span><span class="p">[</span><span class="n">sub_node</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                
                <span class="k">if</span> <span class="n">class_calls</span><span class="p">:</span>
                    <span class="n">max_calls</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">class_calls</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                    <span class="n">max_class</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">class_calls</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                    
                    <span class="c1"># Check if external calls significantly outnumber local calls</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">max_calls</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;FEATURE_ENVY_CALLS&quot;</span><span class="p">]</span> <span class="ow">and</span>
                        <span class="n">max_calls</span> <span class="o">&gt;</span> <span class="n">local_calls</span> <span class="o">*</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># At least twice as many external calls</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span>
                            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Feature Envy&quot;</span><span class="p">,</span>
                            <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Method &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; makes </span><span class="si">{</span><span class="n">max_calls</span><span class="si">}</span><span class="s2"> calls to &#39;</span><span class="si">{</span><span class="n">max_class</span><span class="si">}</span><span class="s2">&#39; but only </span><span class="si">{</span><span class="n">local_calls</span><span class="si">}</span><span class="s2"> local calls in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                            <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                            <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>
                        <span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_inappropriate_intimacy">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_inappropriate_intimacy">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_inappropriate_intimacy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect inappropriate intimacy in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">class_fields</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="n">class_methods</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="n">class_relationships</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>  <span class="c1"># Track inheritance and composition</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
                <span class="c1"># Skip data classes and utility classes</span>
                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                            <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">decorator</span><span class="o">.</span><span class="n">attrname</span> <span class="o">==</span> <span class="s1">&#39;dataclass&#39;</span><span class="p">:</span>
                                <span class="n">is_dataclass</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">is_dataclass</span> <span class="ow">or</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;Utils&#39;</span><span class="p">,</span> <span class="s1">&#39;Helper&#39;</span><span class="p">,</span> <span class="s1">&#39;Factory&#39;</span><span class="p">))):</span>
                    <span class="k">continue</span>

                <span class="c1"># Store class methods and fields</span>
                <span class="n">class_methods</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">mymethods</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)</span>  <span class="c1"># Skip magic methods</span>
                <span class="p">}</span>
                <span class="n">class_fields</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">instance_attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>  <span class="c1"># Skip private fields</span>
                <span class="p">}</span>

                <span class="c1"># Track inheritance relationships</span>
                <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">bases</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">):</span>
                        <span class="n">class_relationships</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

                <span class="c1"># Track composition through instance variables</span>
                <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">instance_attrs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">AssignAttr</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">):</span>
                        <span class="n">class_relationships</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">methods</span> <span class="ow">in</span> <span class="n">class_methods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">other_class</span><span class="p">,</span> <span class="n">other_fields</span> <span class="ow">in</span> <span class="n">class_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">class_name</span> <span class="o">!=</span> <span class="n">other_class</span><span class="p">:</span>
                    <span class="c1"># Skip if there&#39;s a valid relationship</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">other_class</span> <span class="ow">in</span> <span class="n">class_relationships</span><span class="p">[</span><span class="n">class_name</span><span class="p">]</span> <span class="ow">or</span>
                        <span class="n">class_name</span> <span class="ow">in</span> <span class="n">class_relationships</span><span class="p">[</span><span class="n">other_class</span><span class="p">]):</span>
                        <span class="k">continue</span>

                    <span class="n">shared</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">other_fields</span><span class="p">))</span>
                    <span class="n">method_ratio</span> <span class="o">=</span> <span class="n">shared</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span> <span class="k">if</span> <span class="n">methods</span> <span class="k">else</span> <span class="mi">0</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">shared</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;INAPPROPRIATE_INTIMACY_SHARED&quot;</span><span class="p">]</span> <span class="ow">and</span>
                        <span class="n">method_ratio</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">):</span>  <span class="c1"># More than 30% of methods are shared</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span>
                            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Inappropriate Intimacy&quot;</span><span class="p">,</span>
                            <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Class &#39;</span><span class="si">{</span><span class="n">class_name</span><span class="si">}</span><span class="s2">&#39; might be too intimate with &#39;</span><span class="si">{</span><span class="n">other_class</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                                      <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">shared</span><span class="si">}</span><span class="s2"> shared members, </span><span class="si">{</span><span class="n">method_ratio</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> of methods) in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                            <span class="n">module_class</span><span class="o">=</span><span class="n">class_name</span><span class="p">,</span>
                            <span class="n">line_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>
                        <span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_message_chains">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_message_chains">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_message_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect message chains in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">get_chain_length</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">chain</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">node</span>
            <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                <span class="n">length</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">chain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current</span><span class="o">.</span><span class="n">attrname</span><span class="p">)</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">expr</span>
            <span class="k">return</span> <span class="n">length</span><span class="p">,</span> <span class="n">chain</span>

        <span class="k">def</span> <span class="nf">is_builder_pattern</span><span class="p">(</span><span class="n">chain</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Check if the chain follows builder pattern.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s1">&#39;set_&#39;</span><span class="p">,</span> <span class="s1">&#39;with_&#39;</span><span class="p">,</span> <span class="s1">&#39;add_&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">is_common_pattern</span><span class="p">(</span><span class="n">chain</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Check if the chain is a common valid pattern.&quot;&quot;&quot;</span>
            <span class="n">common_patterns</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;logging&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;warning&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;critical&#39;</span><span class="p">},</span>
                <span class="s1">&#39;paths&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;parent&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;suffix&#39;</span><span class="p">,</span> <span class="s1">&#39;stem&#39;</span><span class="p">},</span>
                <span class="s1">&#39;testing&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;assert_&#39;</span><span class="p">,</span> <span class="s1">&#39;expect&#39;</span><span class="p">,</span> <span class="s1">&#39;mock&#39;</span><span class="p">},</span>
                <span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">,</span> <span class="s1">&#39;filter&#39;</span><span class="p">,</span> <span class="s1">&#39;order_by&#39;</span><span class="p">,</span> <span class="s1">&#39;limit&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">method</span> <span class="ow">in</span> <span class="n">pattern</span> <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">)</span> 
                      <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">common_patterns</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">nodes_of_class</span><span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
            <span class="n">chain_length</span><span class="p">,</span> <span class="n">chain</span> <span class="o">=</span> <span class="n">get_chain_length</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            
            <span class="c1"># Skip if it&#39;s a valid pattern</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">chain_length</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;MESSAGE_CHAIN_LENGTH&quot;</span><span class="p">]</span> <span class="ow">or</span>
                <span class="n">is_builder_pattern</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span> <span class="ow">or</span>
                <span class="n">is_common_pattern</span><span class="p">(</span><span class="n">chain</span><span class="p">)):</span>
                <span class="k">continue</span>

            <span class="c1"># Get context for better description</span>
            <span class="n">context</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">node_ancestors</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="p">(</span><span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">)):</span>
                    <span class="n">context</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">name</span>
                    <span class="k">break</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Message Chains&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Long chain (</span><span class="si">{</span><span class="n">chain_length</span><span class="si">}</span><span class="s2"> calls: </span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">chain</span><span class="p">))</span><span class="si">}</span><span class="s2">) &quot;</span>
                           <span class="sa">f</span><span class="s2">&quot;in </span><span class="si">{</span><span class="n">context</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;unknown context&#39;</span><span class="si">}</span><span class="s2"> at line </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                <span class="n">module_class</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
                <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>
            <span class="p">))</span></div>


<div class="viewcode-block" id="CodeSmellDetector.detect_middle_man">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.detect_middle_man">[docs]</a>
    <span class="k">def</span> <span class="nf">detect_middle_man</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect middle man classes in the given module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
                <span class="c1"># Skip known patterns and small classes</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;Proxy&#39;</span><span class="p">,</span> <span class="s1">&#39;Delegate&#39;</span><span class="p">,</span> <span class="s1">&#39;Adapter&#39;</span><span class="p">,</span> <span class="s1">&#39;Facade&#39;</span><span class="p">))</span> <span class="ow">or</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">):</span>  <span class="c1"># Very small classes might be intentional adapters</span>
                    <span class="k">continue</span>

                <span class="n">methods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">mymethods</span><span class="p">())</span>
                <span class="n">total_methods</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">total_methods</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">delegating_methods</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">delegate_targets</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                    <span class="c1"># Skip property methods and magic methods</span>
                    <span class="n">is_property</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="n">method</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                                <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>
                            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decorator</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                                    <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                                    <span class="k">break</span>
                            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                                <span class="k">if</span> <span class="n">decorator</span><span class="o">.</span><span class="n">attrname</span> <span class="o">==</span> <span class="s1">&#39;property&#39;</span><span class="p">:</span>
                                    <span class="n">is_property</span> <span class="o">=</span> <span class="kc">True</span>
                                    <span class="k">break</span>

                    <span class="k">if</span> <span class="n">is_property</span> <span class="ow">or</span> <span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
                        <span class="k">continue</span>

                    <span class="c1"># Check if method is just delegating</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Return</span><span class="p">):</span>
                        <span class="n">return_value</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_value</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Call</span><span class="p">):</span>
                            <span class="n">delegating_methods</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="c1"># Track which object we&#39;re delegating to</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_value</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Attribute</span><span class="p">):</span>
                                <span class="n">delegate_targets</span><span class="p">[</span><span class="n">return_value</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">as_string</span><span class="p">()]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

                <span class="n">delegation_ratio</span> <span class="o">=</span> <span class="n">delegating_methods</span> <span class="o">/</span> <span class="n">total_methods</span> <span class="k">if</span> <span class="n">total_methods</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">delegation_ratio</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s2">&quot;MIDDLE_MAN_RATIO&quot;</span><span class="p">]</span> <span class="ow">and</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">delegate_targets</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># Only flag if delegating to 1-2 objects</span>
                    <span class="n">primary_delegate</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">delegate_targets</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_smell</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Middle Man&quot;</span><span class="p">,</span>
                        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Class &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; delegates </span><span class="si">{</span><span class="n">delegating_methods</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total_methods</span><span class="si">}</span><span class="s2"> methods &quot;</span>
                                  <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">delegation_ratio</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">), mainly to </span><span class="si">{</span><span class="n">primary_delegate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">module_class</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">line_number</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>
                    <span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.print_report">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.print_report">[docs]</a>
    <span class="k">def</span> <span class="nf">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print a report of all detected code smells.</span>

<span class="sd">        If no code smells are detected, it prints a message indicating so.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No code smells detected.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detected Code Smells:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">smell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">smell</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">smell</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="CodeSmellDetector.add_smell">
<a class="viewcode-back" href="../../code_smell_detector.html#code_quality_analyzer.code_smell_detector.CodeSmellDetector.add_smell">[docs]</a>
    <span class="k">def</span> <span class="nf">add_smell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">module_class</span><span class="p">,</span> <span class="n">line_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a detected smell to the list of code smells.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the smell</span>
<span class="sd">            description (str): Description of the smell</span>
<span class="sd">            file_path (str): Path to the file containing the smell</span>
<span class="sd">            module_class (str): The module or class containing the smell</span>
<span class="sd">            line_number (int, optional): The line number where the smell was detected</span>
<span class="sd">            severity (str, optional): The severity level of the smell (default: &#39;medium&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code_smells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CodeSmell</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
            <span class="n">module_class</span><span class="o">=</span><span class="n">module_class</span><span class="p">,</span>
            <span class="n">line_number</span><span class="o">=</span><span class="n">line_number</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="n">severity</span>
        <span class="p">))</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Your Name.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>